<!DOCTYPE html>
<html>
<head>
    <title>Toy Web Pages Inc. - Sports</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"
            integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" 
            crossorigin="anonymous"></script>

    <link href="TWPIstyles.css" rel="stylesheet" />
    <style>
        h2 {
            color: red;
        }
    </style>
</head>
<body>


    <header>
        Toy Web Pages Inc.  &#9786;
    </header>

    <nav id="topNav">
        <a href="default.html">Home</a> <a href="Toys.html">Toys</a> <a href="Sports.html">Sports</a> <a href="InfoRequest.html">More Information</a>
    </nav>

    <section>

        <h1>Sporting Goods!</h1>

        <article>
            <h2>Bicycles</h2>
            Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Maecenas porttitor congue massa. Fusce posuere, magna sed pulvinar ultricies, purus lectus malesuada libero, sit amet commodo magna eros quis urna.Nunc viverra imperdiet enim. Fusce est. Vivamus a tellus. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Proin pharetra nonummy pede. Mauris et orci.
            <br>
            <br>
            Select a color: 
            <select id="bikecolor">
                <option value="">Select a bike color...</option>
                <option value="">All</option>
                <option>Black</option>
                <option>Blue</option>
                <option>Green</option>
                <option>Red</option>
                <option>Silver</option>
                <option>Yellow</option>                
            </select>
            <br>

            <table id="products">
            </table>
            
            <div id="status" style="display:none">Working...</div>

<div id="rawdata"></div>
        </article>


    </section>
    <br />
    <footer>
        Copyright &copy; 2017 TWPinc.   <a href="AboutUs.html">About</a>    <a href="Contact.html">Contact Us</a>    <a href="Privacy.html">Privacy</a>
    </footer>




<script>
    // Add code here to add the event handler function below to 
    // to the select list's 

    (function() {
        var selColor = document.getElementById("bikecolor");
        selColor.onchange = function() {GetBikes(this);}
    })();


    // Add an event handler function here to fetch the Bikes data
    // from the web service

    function GetBikes(select)
    {
        var color =  select.options[select.selectedIndex].value;

        var workingmsg = document.getElementById("status");
        workingmsg.style.display="block";

        var dummyData = '{"odata.metadata":"http://maxrestdemo.azurewebsites.net/odata/$metadata#Bikes","value":[{"id":749,"color":"Red","category":"Road","size":62,"price":3578.27},{"id":750,"color":"Red","category":"Road","size":44,"price":3578.27},{"id":751,"color":"Red","category":"Road","size":48,"price":3578.27},{"id":752,"color":"Red","category":"Road","size":52,"price":3578.27},{"id":753,"color":"Red","category":"Road","size":56,"price":3578.27},{"id":754,"color":"Red","category":"Road","size":58,"price":1457.99},{"id":755,"color":"Red","category":"Road","size":60,"price":1457.99},{"id":756,"color":"Red","category":"Road","size":44,"price":1457.99},{"id":757,"color":"Red","category":"Road","size":48,"price":1457.99},{"id":758,"color":"Red","category":"Road","size":52,"price":1457.99},{"id":759,"color":"Red","category":"Road","size":58,"price":782.99},{"id":760,"color":"Red","category":"Road","size":60,"price":782.99},{"id":761,"color":"Red","category":"Road","size":62,"price":782.99},{"id":762,"color":"Red","category":"Road","size":44,"price":782.99},{"id":763,"color":"Red","category":"Road","size":48,"price":782.99},{"id":764,"color":"Red","category":"Road","size":52,"price":782.99},{"id":765,"color":"Black","category":"Road","size":58,"price":782.99},{"id":766,"color":"Black","category":"Road","size":60,"price":782.99},{"id":767,"color":"Black","category":"Road","size":62,"price":782.99},{"id":768,"color":"Black","category":"Road","size":44,"price":782.99},{"id":769,"color":"Black","category":"Road","size":48,"price":782.99},{"id":770,"color":"Black","category":"Road","size":52,"price":782.99},{"id":771,"color":"Silver","category":"Mountain","size":38,"price":3399.99},{"id":772,"color":"Silver","category":"Mountain","size":42,"price":3399.99},{"id":773,"color":"Silver","category":"Mountain","size":44,"price":3399.99},{"id":774,"color":"Silver","category":"Mountain","size":48,"price":3399.99},{"id":775,"color":"Black","category":"Mountain","size":38,"price":3374.99},{"id":776,"color":"Black","category":"Mountain","size":42,"price":3374.99},{"id":777,"color":"Black","category":"Mountain","size":44,"price":3374.99},{"id":778,"color":"Black","category":"Mountain","size":48,"price":3374.99},{"id":779,"color":"Silver","category":"Mountain","size":38,"price":2319.99},{"id":780,"color":"Silver","category":"Mountain","size":42,"price":2319.99},{"id":781,"color":"Silver","category":"Mountain","size":46,"price":2319.99},{"id":782,"color":"Black","category":"Mountain","size":38,"price":2294.99},{"id":783,"color":"Black","category":"Mountain","size":42,"price":2294.99},{"id":784,"color":"Black","category":"Mountain","size":46,"price":2294.99},{"id":785,"color":"Black","category":"Mountain","size":38,"price":1079.99},{"id":786,"color":"Black","category":"Mountain","size":40,"price":1079.99},{"id":787,"color":"Black","category":"Mountain","size":44,"price":1079.99},{"id":788,"color":"Black","category":"Mountain","size":48,"price":1079.99},{"id":789,"color":"Red","category":"Road","size":44,"price":2443.35},{"id":790,"color":"Red","category":"Road","size":48,"price":2443.35},{"id":791,"color":"Red","category":"Road","size":52,"price":2443.35},{"id":792,"color":"Red","category":"Road","size":58,"price":2443.35},{"id":793,"color":"Black","category":"Road","size":44,"price":2443.35},{"id":794,"color":"Black","category":"Road","size":48,"price":2443.35},{"id":795,"color":"Black","category":"Road","size":52,"price":2443.35},{"id":796,"color":"Black","category":"Road","size":58,"price":2443.35},{"id":797,"color":"Yellow","category":"Road","size":38,"price":1120.49},{"id":798,"color":"Yellow","category":"Road","size":40,"price":1120.49},{"id":799,"color":"Yellow","category":"Road","size":42,"price":1120.49},{"id":800,"color":"Yellow","category":"Road","size":44,"price":1120.49},{"id":801,"color":"Yellow","category":"Road","size":48,"price":1120.49},{"id":953,"color":"Blue","category":"Touring","size":60,"price":1214.85},{"id":954,"color":"Yellow","category":"Touring","size":46,"price":2384.07},{"id":955,"color":"Yellow","category":"Touring","size":50,"price":2384.07},{"id":956,"color":"Yellow","category":"Touring","size":54,"price":2384.07},{"id":957,"color":"Yellow","category":"Touring","size":60,"price":2384.07},{"id":958,"color":"Blue","category":"Touring","size":54,"price":742.35},{"id":959,"color":"Blue","category":"Touring","size":58,"price":742.35},{"id":960,"color":"Blue","category":"Touring","size":62,"price":742.35},{"id":961,"color":"Yellow","category":"Touring","size":44,"price":742.35},{"id":962,"color":"Yellow","category":"Touring","size":50,"price":742.35},{"id":963,"color":"Yellow","category":"Touring","size":54,"price":742.35},{"id":964,"color":"Yellow","category":"Touring","size":58,"price":742.35},{"id":965,"color":"Yellow","category":"Touring","size":62,"price":742.35},{"id":966,"color":"Blue","category":"Touring","size":46,"price":2384.07},{"id":967,"color":"Blue","category":"Touring","size":50,"price":2384.07},{"id":968,"color":"Blue","category":"Touring","size":54,"price":2384.07},{"id":969,"color":"Blue","category":"Touring","size":60,"price":2384.07},{"id":970,"color":"Blue","category":"Touring","size":46,"price":1214.85},{"id":971,"color":"Blue","category":"Touring","size":50,"price":1214.85},{"id":972,"color":"Blue","category":"Touring","size":54,"price":1214.85},{"id":973,"color":"Yellow","category":"Road","size":40,"price":1700.99},{"id":974,"color":"Yellow","category":"Road","size":42,"price":1700.99},{"id":975,"color":"Yellow","category":"Road","size":44,"price":1700.99},{"id":976,"color":"Yellow","category":"Road","size":48,"price":1700.99},{"id":977,"color":"Black","category":"Road","size":58,"price":539.99},{"id":978,"color":"Blue","category":"Touring","size":44,"price":742.35},{"id":979,"color":"Blue","category":"Touring","size":50,"price":742.35},{"id":980,"color":"Silver","category":"Mountain","size":38,"price":769.49},{"id":981,"color":"Silver","category":"Mountain","size":40,"price":769.49},{"id":982,"color":"Silver","category":"Mountain","size":42,"price":769.49},{"id":983,"color":"Silver","category":"Mountain","size":46,"price":769.49},{"id":984,"color":"Silver","category":"Mountain","size":40,"price":564.99},{"id":985,"color":"Silver","category":"Mountain","size":42,"price":564.99},{"id":986,"color":"Silver","category":"Mountain","size":44,"price":564.99},{"id":987,"color":"Silver","category":"Mountain","size":48,"price":564.99},{"id":988,"color":"Silver","category":"Mountain","size":52,"price":564.99},{"id":989,"color":"Black","category":"Mountain","size":40,"price":539.99},{"id":990,"color":"Black","category":"Mountain","size":42,"price":539.99},{"id":991,"color":"Black","category":"Mountain","size":44,"price":539.99},{"id":992,"color":"Black","category":"Mountain","size":48,"price":539.99},{"id":993,"color":"Black","category":"Mountain","size":52,"price":539.99},{"id":997,"color":"Black","category":"Road","size":44,"price":539.99},{"id":998,"color":"Black","category":"Road","size":48,"price":539.99},{"id":999,"color":"Black","category":"Road","size":52,"price":539.99},{"id":1000,"color":"Red","category":"Road","size":62,"price":3578.27},{"id":1001,"color":"Red","category":"Road","size":62,"price":3578.27},{"id":1002,"color":"Red","category":"Road","size":62,"price":3578.27},{"id":1003,"color":"Purple","category":"Road","size":62,"price":100.27}]}';
        var dummyDataObject = JSON.parse(dummyData);

        if (color!="") 
        {
            // the JSON returned has two properties: "odata.metadata" and "value".
            // "value" is the collection of bikes.
            var bikes = dummyDataObject.value;

            // filter the data using jQuery .filter function.
            // you could also write a FOR loop to build a new object with matching data.
            var filtereddata =  $(bikes)
                .filter(function (i,n){
                    return n.color===color;
                });

            dummyDataObject.value = filtereddata;
        }

        // the code for UpdateTable is unchanged from the full Ajax version.
        UpdateTable(dummyDataObject);
    }



    // Write a function to be called from the Ajax success function. 
    // Add rows to the the existing HTML table.

    function UpdateTable(data) {
        // Update the status ("working...") message.
        var workingmsg = document.getElementById("status");
        workingmsg.style.display="block";

        //The JSON returned starts with a top level object named "value".
        var BikesList = data.value;

        // Add rows to the HTML table
        var products = document.getElementById("products");
        products.innerHTML="";  // clear the existing content
        var rownum =  0;
        var row;
        var cell;

        // Add the column headings row
        // row = products.insertRow(rownum);
        // cell = row.insertCell(0);
        // cell.innerHTML = "ID";
        // cell = row.insertCell(1);
        // cell.innerHTML = "Color";
        // cell = row.insertCell(2);
        // cell.innerHTML = "Category";
        // cell = row.insertCell(3);
        // cell.innerHTML = "Size";
        // cell = row.insertCell(4);
        // cell.innerHTML = "Price";
        // rownum++;

        // Add the column headings row (using a loop)
        row = products.insertRow(rownum);
        var headings = ["ID", "Color", "Category", "Size", "Price"];
        for (var i = 0; i < headings.length; i++) {
            row.insertCell(i).innerHTML = headings[i];                
        }
        rownum++;

        // // add each product to a row
        // for (var index = 0; index < BikesList.length; index++) {
        //     var item = BikesList[index];
        //     row = products.insertRow(rownum);
        //     cell = row.insertCell(0);
        //     cell.innerHTML = item.id;
        //     cell = row.insertCell(1);
        //     cell.innerHTML = item.color;
        //     cell = row.insertCell(2);
        //     cell.innerHTML = item.category;
        //     cell = row.insertCell(3);
        //     cell.innerHTML = item.size;
        //     cell = row.insertCell(4);
        //     cell.innerHTML = "$" + item.price.toLocaleString();
        //     rownum++;
        // }

        // add each product to a row (using a loop)
        for (var index = 0; index < BikesList.length; index++) {
            var item = BikesList[index];
            row = products.insertRow(rownum);
            var properties = ["id", "color", "category", "size", "price"];
            for (var i = 0; i < properties.length; i++) {
                row.insertCell(i).innerHTML = item[properties[i]];
            }
            rownum++;
        }



        // hide the "working..." message
        workingmsg.style.display="none";

    }

    
</script>

    <style>
        tr:first-child { color:orange; font-weight: bold;}
        td {border:1px solid black;}
        td:nth-of-type(4), td:nth-of-type(5) {text-align: right}
    </style>

    <script src="MenuPopups.js"></script>

</body>
</html>
